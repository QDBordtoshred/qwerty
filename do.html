<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">

  <style>
    body {
      background-color: #1a2f36;
      transform: scale(0.25);
      transform-origin: top left;
      width: 400%; /* Adjust the width to compensate for the scaling */
      height: 400%; /* Adjust the height to compensate for the scaling */
    }

    h1 {
      text-align: center;
      width: 100%;
      color: #ffffff;
      position: absolute;
      top: 0;
    }
  </style>

  <script>
    window.console = window.console || function (t) {};
  </script>
</head>

<body translate="no">
  <script src='//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.5/dat.gui.min.js'></script>
  <script id="rendered-js">
    function Sprite(src, spriteWidth, spriteHeight, modes) {
      var mode = null;
      var frameId = 0;
      var totalFrames = 1;
      var _sprite = this;
      var xBG = 0;
      var yBG = 0;

      // consruct
      var init = _init();
      _sprite.update = _update;
      _sprite.setMode = _setMode;

      function _init() {
        _sprite.domElement = document.createElement('div');
        _sprite.domElement.style.position = 'relative';
        _sprite.domElement.style.width = spriteWidth / 4 + 'px'; // Scale down width
        _sprite.domElement.style.height = spriteHeight / 4 + 'px'; // Scale down height
        _sprite.domElement.style.display = 'block';
        _sprite.domElement.style.backgroundImage = 'url("' + src + '")';
      };

      function _update() {
        frameId++;
        xBG = -mode.x - spriteWidth * (frameId % totalFrames);
        _sprite.domElement.style.backgroundPositionX = xBG + 'px';
      }

      function _setMode(id) {
        mode = modes[id];
        frameId = 0;
        totalFrames = mode.frames;
        _sprite.domElement.style.backgroundPositionX = -mode.x + 'px';
        _sprite.domElement.style.backgroundPositionY = -mode.y + 'px';
      }

      return _sprite;
    }


    // Testing...
    var animModes = {
      walkRight: { frames: 6, x: 0, y: 1 },
      walkLeft: { frames: 6, x: 0, y: 151 },
      stopRight: { frames: 1, x: 0, y: 301 },
      stopLeft: { frames: 1, x: 104, y: 301 }
    };


    var playerDirection = 'Right';
    var playerMode = 'stop';
    var player = new Sprite('http://atomicrobotdesign.com/blog_media/sprite_movement/images/gb_walk.png', 104, 150, animModes);
    player.setMode('stop' + playerDirection);
    player.domElement.style.top = '25px'; // Adjusted initial top position
    player.domElement.style.left = '25px'; // Adjusted initial left position

    document.body.appendChild(player.domElement);

    // Add key controls
    window.onkeydown = keyDownListener;
    window.onkeyup = keyUpListener;

    function keyDownListener(e) {
      switch (e.keyCode) {
        case 37: // LEFT
          if (playerMode != 'walk') {
            playerDirection = 'Left';
            playerMode = 'walk';
            player.setMode(playerMode + playerDirection);
          }
          break;

        case 39: // RIGHT
          if (playerMode != 'walk') {
            playerDirection = 'Right';
            playerMode = 'walk';
            player.setMode(playerMode + playerDirection);
          }
          break;
      }
    }

    function keyUpListener() {
      playerMode = 'stop';
      player.setMode(playerMode + playerDirection);
    }

    function render() {
      player.update();

      var x = player.domElement.style.left ? parseInt(player.domElement.style.left) : 0;
      var y = player.domElement.style.top ? parseInt(player.domElement.style.top) : 0;

      if (playerMode == 'walk') {
        if (playerDirection == 'Left') x -= 5; // Adjusted movement distance
        if (playerDirection == 'Right') x += 5; // Adjusted movement distance

        player.domElement.style.left = x + 'px';
      }
    }
    var fps = 8;
    setInterval(render, 1000 / fps);
    //# sourceURL=pen.js
  </script>
</body>

</html>
